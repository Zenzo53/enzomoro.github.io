<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Projects | Enzo Moro</title>
    <meta name="description" content="Cybersecurity projects: incident response, security engineering, and community leadership." />
    <link rel="canonical" href="https://yourdomain.com/projects.html" />
    <link rel="stylesheet" href="css/styles.css" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
    />
  </head>
  <body>
    <a href="#main" class="skip-to-content">Skip to main content</a>

    <header role="banner">
      <nav role="navigation" aria-label="Main navigation">
        <div class="logo">Enzo Moro</div>
        <button class="menu-toggle" aria-label="Toggle navigation menu">
          ‚ò∞
        </button>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="projects.html" class="active">Projects</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
              <span class="theme-icon">‚òÄÔ∏è</span>
            </button>
          </li>
        </ul>
      </nav>
    </header>

    <main id="main" role="main">
      <!-- Hero -->
      <section
        class="hero"
        style="min-height: 50vh; padding: var(--spacing-2xl) var(--spacing-lg)"
      >
        <div class="hero-content">
          <h1>Projects</h1>
          <p class="subtitle">Security engineering, incident response, and community initiatives</p>
        </div>
      </section>

      <!-- Filter Controls -->
      <section style="padding: var(--spacing-lg) var(--spacing-lg); text-align: center;">
        <div class="container">
          <button class="btn btn-small" data-filter="all">All Projects</button>
          <button class="btn btn-small" data-filter="Security Engineering">Security Engineering</button>
          <button class="btn btn-small" data-filter="Red Team">Red Team</button>
          <button class="btn btn-small" data-filter="Infrastructure & DevOps">Infrastructure</button>
        </div>
      </section>

      <!-- Projects Grid -->
      <section id="projects-section" role="region" aria-label="Projects">
        <div class="container">
          <div id="projects-grid" class="grid grid-2"></div>
        </div>
      </section>
    </main>

    <!-- Project Detail Modal -->
    <div id="project-modal" class="modal">
      <div class="modal-content">
        <button class="modal-close" aria-label="Close modal">‚úï</button>
        <div id="modal-body"></div>
      </div>
    </div>

    <footer role="contentinfo">
      <div class="social-links">
        <a href="https://github.com" target="_blank" rel="noopener noreferrer" title="GitHub"
          >üêô GitHub</a
        >
        <a
          href="https://www.linkedin.com/in/enzocmoro/"
          target="_blank"
          rel="noopener noreferrer"
          title="LinkedIn"
          >üíº LinkedIn</a
        >
        <a href="https://open.spotify.com/user/enzocmoro-br?si=728c3e573cd54afa" target="_blank" rel="noopener noreferrer" title="Spotify"
          >üéµ Spotify</a
        >
        <a href="mailto:enzocmoro@gmail.com" title="Email">üìß Email</a>
      </div>
      <div class="footer-content">
        <p>¬© 2025 Enzo Moro. All rights reserved.</p>
      </div>
    </footer>

    <script src="js/theme.js"></script>
    <script src="js/scroll-to-top.js"></script>
    <script src="js/lightbox.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/main.js"></script>
    <script>
      let allProjects = [];

      // Load projects from JSON
      async function loadProjects() {
        try {
          const response = await fetch("assets/data/projects.json");
          const data = await response.json();
          allProjects = data.projects;
          renderProjects(allProjects);
          attachFilterListeners();
        } catch (error) {
          console.error("Error loading projects:", error);
        }
      }

      function renderProjects(projects) {
        const grid = document.getElementById("projects-grid");
        grid.innerHTML = "";

        if (projects.length === 0) {
          grid.innerHTML = "<p>No projects found.</p>";
          return;
        }

        projects.forEach((project) => {
          const card = document.createElement("div");
          card.className = "card";
          card.id = `project-${project.id}`;

          const techBadges = project.tech
            .map((t) => `<span class="badge">${t}</span>`)
            .join("");

          card.innerHTML = `
            <h3>${project.title}</h3>
            <p><strong>${project.role}</strong> ‚Ä¢ <span style="color: var(--color-accent-secondary)">${project.category}</span></p>
            <p>${project.summary}</p>
            <div style="margin-bottom: var(--spacing-lg)">${techBadges}</div>
            <button class="btn btn-small" onclick="openProjectModal(${project.id})">View Details</button>
            ${
              project.repo_url
                ? `<a href="${project.repo_url}" target="_blank" rel="noopener noreferrer" class="btn btn-small" style="margin-left: var(--spacing-sm)">GitHub</a>`
                : ""
            }
          `;

          grid.appendChild(card);
        });
      }

      function attachFilterListeners() {
        document.querySelectorAll("[data-filter]").forEach((btn) => {
          btn.addEventListener("click", () => {
            const filter = btn.getAttribute("data-filter");

            // Update active button
            document.querySelectorAll("[data-filter]").forEach((b) => {
              b.classList.remove("active");
            });
            btn.classList.add("active");

            // Filter projects
            if (filter === "all") {
              renderProjects(allProjects);
            } else {
              const filtered = allProjects.filter(
                (p) => p.category === filter
              );
              renderProjects(filtered);
            }
          });
        });

        // Set first button as active
        document.querySelector("[data-filter='all']").classList.add("active");
      }

      function openProjectModal(projectId) {
        const project = allProjects.find((p) => p.id === projectId);
        if (!project) return;

        const modalBody = document.getElementById("modal-body");
        const highlightsList = project.highlights
          .map((h) => `<li>${h}</li>`)
          .join("");

        const techBadges = project.tech
          .map((t) => `<span class="badge">${t}</span>`)
          .join("");

        modalBody.innerHTML = `
          <h2>${project.title}</h2>
          <p><strong>Role:</strong> ${project.role}</p>
          <p><strong>Category:</strong> ${project.category}</p>
          
          <h3>Summary</h3>
          <p>${project.summary}</p>
          
          <h3>Key Highlights</h3>
          <ul>
            ${highlightsList}
          </ul>
          
          <h3>Tech Stack</h3>
          <div style="margin-bottom: var(--spacing-lg)">${techBadges}</div>
          
          ${
            project.repo_url
              ? `<a href="${project.repo_url}" target="_blank" rel="noopener noreferrer" class="btn">View Repository</a>`
              : ""
          }
          ${
            project.live_url
              ? `<a href="${project.live_url}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary" style="margin-left: var(--spacing-md)">View Live</a>`
              : ""
          }
        `;

        document.getElementById("project-modal").classList.add("active");
      }

      // Close modal listeners
      document.querySelector(".modal-close").addEventListener("click", () => {
        document.getElementById("project-modal").classList.remove("active");
      });

      document
        .getElementById("project-modal")
        .addEventListener("click", (e) => {
          if (e.target.id === "project-modal") {
            e.target.classList.remove("active");
          }
        });

      // Load projects on page load
      document.addEventListener("DOMContentLoaded", loadProjects);
    </script>
  </body>
</html>
